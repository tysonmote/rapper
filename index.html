<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Documentation by YARD 0.6.4</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>rapper</h1>

<p>Static asset packager and compressor with versioning and built-in view helpers. Easy to configure, easy to use, and easy to ignore when you want to. No crazy JavaScript comment DSLs, either.</p>

<p>Merb and Sinatra view helpers are coming soon, as well as pluggable compression backends (YUI Compressor, Google Closure Compiler, etc.) <code>rapper</code> currently only includes Google Closure Compiler.</p>

<h2>Packaging assets without wanting to claw your eyes out</h2>

<ol>
<li>Create a config file and one or more asset type definition files.</li>
<li><p>Load <code>rapper</code> with the config path and current environment:</p>

<pre class="code"> <span class='engine identifier id'>engine</span> <span class='assign token'>=</span> <span class='Rapper constant id'>Rapper</span><span class='colon2 op'>::</span><span class='Engine constant id'>Engine</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='string val'>&quot;config/assets.yml&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;development&quot;</span> <span class='rparen token'>)</span>
</pre></li>
<li><p>Then package the assets:</p>

<pre class="code"> <span class='engine identifier id'>engine</span><span class='dot token'>.</span><span class='package identifier id'>package</span>
</pre></li>
<li><p>That's it. Stop fussing with ridiculous asset packagers that want you to spend an hour shuffling files around for them.</p></li>
</ol>


<h2>Rapper configuration</h2>

<p>Rapper is configured using a YAML file that defines the settings to be used in various server environments. Example:</p>

<pre class="code"><span class='base identifier id'>base</span><span class='colon op'>:</span> <span class='bitand op'>&amp;</span><span class='base identifier id'>base</span>
  <span class='definition_root identifier id'>definition_root</span><span class='colon op'>:</span> <span class='config identifier id'>config</span><span class='div op'>/</span><span class='assets identifier id'>assets</span>
  <span class='tag_style identifier id'>tag_style</span><span class='colon op'>:</span> <span class='html identifier id'>html</span>   <span class='comment val'># optional, [&quot;html&quot;, &quot;xhtml&quot;, &quot;html5&quot;], default: html5</span>

<span class='development identifier id'>development</span><span class='colon op'>:</span>
  <span class='lshft op'>&lt;&lt;</span><span class='colon op'>:</span> <span class='mult op'>*</span><span class='base identifier id'>base</span>
  <span class='bundle identifier id'>bundle</span><span class='colon op'>:</span> <span class='false false kw'>false</span>     <span class='comment val'># optional, default: true</span>
  <span class='compress identifier id'>compress</span><span class='colon op'>:</span> <span class='false false kw'>false</span>   <span class='comment val'># optional, default: true</span>
  <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='false false kw'>false</span>    <span class='comment val'># optional, default: true</span>
  <span class='log identifier id'>log</span><span class='colon op'>:</span> <span class='stdout identifier id'>stdout</span>       <span class='comment val'># optional, [&quot;stdout&quot;, file path], default: off</span>
  <span class='log_verbose identifier id'>log_verbose</span><span class='colon op'>:</span> <span class='true true kw'>true</span> <span class='comment val'># optional, default: off</span>

<span class='production identifier id'>production</span><span class='colon op'>:</span>
  <span class='lshft op'>&lt;&lt;</span><span class='colon op'>:</span> <span class='mult op'>*</span><span class='base identifier id'>base</span>
  <span class='bundle identifier id'>bundle</span><span class='colon op'>:</span> <span class='true true kw'>true</span>
  <span class='compress identifier id'>compress</span><span class='colon op'>:</span> <span class='true true kw'>true</span>
  <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='true true kw'>true</span>
  <span class='comment val'># optional, passed to Google Closure Compiler</span>
  <span class='yui_compressor identifier id'>yui_compressor</span><span class='colon op'>:</span>
    <span class='line_break identifier id'>line_break</span><span class='colon op'>:</span> <span class='integer val'>2000</span>           <span class='comment val'># default: 2000</span>
    <span class='munge identifier id'>munge</span><span class='colon op'>:</span> <span class='false false kw'>false</span>               <span class='comment val'># default: false</span>
    <span class='optimize identifier id'>optimize</span><span class='colon op'>:</span> <span class='true true kw'>true</span>             <span class='comment val'># default: true</span>
    <span class='preserve_semicolons identifier id'>preserve_semicolons</span><span class='colon op'>:</span> <span class='false false kw'>false</span> <span class='comment val'># default: false</span>
</pre>

<p>The only required setting is <code>definition_root</code>. (Of course, you'll still need definition files to define the asset packages that you want build. More on that below.)</p>

<h2>Rapper definitions</h2>

<p>The <code>definition_root</code> setting in the rapper config is a path to a folder containing more YAML files that define the various types of bundles you want to build (eg. <code>stylesheets.yml</code>, <code>javascripts.yml</code>). For example, JavaScripts:</p>

<pre class="code"><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span> <span class='notop op'>!</span><span class='omap identifier id'>omap</span>
<span class='minus op'>-</span> <span class='root identifier id'>root</span><span class='colon op'>:</span> <span class='public identifier id'>public</span><span class='div op'>/</span><span class='javascripts identifier id'>javascripts</span>
<span class='minus op'>-</span> <span class='destination_root identifier id'>destination_root</span><span class='colon op'>:</span> <span class='public identifier id'>public</span><span class='div op'>/</span><span class='assets identifier id'>assets</span> <span class='comment val'># optional, default: root + &quot;/assets&quot;</span>
<span class='minus op'>-</span> <span class='component_tag_root identifier id'>component_tag_root</span><span class='colon op'>:</span> <span class='regexp val'>/javascripts
- asset_tag_root: /</span><span class='javascripts identifier id'>javascripts</span><span class='div op'>/</span><span class='assets identifier id'>assets</span>
<span class='minus op'>-</span> <span class='suffix identifier id'>suffix</span><span class='colon op'>:</span> <span class='js identifier id'>js</span>
<span class='minus op'>-</span> <span class='assets identifier id'>assets</span><span class='colon op'>:</span> <span class='notop op'>!</span><span class='omap identifier id'>omap</span>
    <span class='minus op'>-</span> <span class='base identifier id'>base</span><span class='colon op'>:</span> <span class='notop op'>!</span><span class='omap identifier id'>omap</span>
        <span class='minus op'>-</span> <span class='files identifier id'>files</span><span class='colon op'>:</span> 
          <span class='minus op'>-</span> <span class='mootools identifier id'>mootools</span>
        <span class='minus op'>-</span> <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='integer val'>7</span><span class='b06 identifier id'>b06</span>
    <span class='minus op'>-</span> <span class='stats identifier id'>stats</span><span class='colon op'>:</span> <span class='notop op'>!</span><span class='omap identifier id'>omap</span>
        <span class='minus op'>-</span> <span class='files identifier id'>files</span><span class='colon op'>:</span> 
          <span class='minus op'>-</span> <span class='protovis identifier id'>protovis</span>
          <span class='minus op'>-</span> <span class='ext_js_full identifier id'>ext_js_full</span>
        <span class='minus op'>-</span> <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='db62 identifier id'>db62</span>
</pre>

<p>The above definition will create two asset files: <code>public/assets/base.js</code> and <code>public/assets/stats.js</code> from the component files in <code>public/javascripts</code> (in this case: <code>public/javascripts/protovis.js</code> and <code>public/javascripts/ext_js_full.js</code>).</p>

<p><strong>Note:</strong> Definition files are YAML ordered mapping documents. This is so that version updates (which involves rapper updating the version numbers and writing out the updated definition as YAML) don't change the order of the file. This is especially useful when using git and merging branches because it prevents nasty merge conflicts.</p>

<h2>Combining bundles</h2>

<p>Rapper allows you to combine bundles by referring to the other bundle with a "+"
prefix in the files list:</p>

<pre class="code"><span class='minus op'>-</span> <span class='assets identifier id'>assets</span><span class='colon op'>:</span> <span class='notop op'>!</span><span class='omap identifier id'>omap</span>
    <span class='minus op'>-</span> <span class='base identifier id'>base</span><span class='colon op'>:</span> <span class='notop op'>!</span><span class='omap identifier id'>omap</span>
        <span class='minus op'>-</span> <span class='files identifier id'>files</span><span class='colon op'>:</span> 
          <span class='minus op'>-</span> <span class='mootools identifier id'>mootools</span>
        <span class='minus op'>-</span> <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='integer val'>7</span><span class='b06 identifier id'>b06</span>
    <span class='minus op'>-</span> <span class='extras identifier id'>extras</span><span class='colon op'>:</span> <span class='notop op'>!</span><span class='omap identifier id'>omap</span>
        <span class='minus op'>-</span> <span class='files identifier id'>files</span><span class='colon op'>:</span> 
          <span class='minus op'>-</span> <span class='mootools identifier id'>mootools</span><span class='minus op'>-</span><span class='more identifier id'>more</span>
          <span class='minus op'>-</span> <span class='protovis identifier id'>protovis</span>
        <span class='minus op'>-</span> <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='integer val'>25</span><span class='c1 identifier id'>c1</span>
    <span class='minus op'>-</span> <span class='full identifier id'>full</span><span class='colon op'>:</span> <span class='notop op'>!</span><span class='omap identifier id'>omap</span>
        <span class='minus op'>-</span> <span class='files identifier id'>files</span><span class='colon op'>:</span> 
          <span class='minus op'>-</span> <span class='plus op'>+</span><span class='base identifier id'>base</span>
          <span class='minus op'>-</span> <span class='plus op'>+</span><span class='extras identifier id'>extras</span>
        <span class='minus op'>-</span> <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='db62 identifier id'>db62</span>
</pre>

<h2>View helpers</h2>

<p>Rapper provides helper methods to generate HTML include tags for your assets in the <code>Rapper::ViewHelpers</code> module. Simply <code>include</code> it in the appropriate place for your web app / framework / widget / spaceship / row boat / whatever. It's automaticallly included for Merb because Merb people are notoriously lazy.</p>

<p>Rapper's view helpers respect your <code>bundle</code> setting. If it is <code>true</code>, a singe include tag for the joined asset will be returned. If bundling is <code>false</code>, it will return include tags for every component file of the asset (as a single string).</p>

<p>Rapper provides helper methods for each definition type. For instance, if you have "javascripts.yml" and "stylesheets.yml" definition files, Rapper will provide <code>include_javascripts</code> and <code>include_stylesheets</code> helper methods. Just pass the name of the asset to the helper method as a symbol and the correct HTML will be returned:</p>

<pre class="code"><span class='include_stylesheets identifier id'>include_stylesheets</span> <span class='symbol val'>:mootools</span>
<span class='comment val'># &lt;script src=&quot;/javascripts/assets/mootools.js&quot;&gt;&lt;/script&gt;</span>
</pre>

<h2>Versioning</h2>

<p>Version strings are short hashes of the before-compression asset file. This means that they will only change when the contents of the component files for an asset change and time-consuming compression will only happen when a bundle needs to be re-packaged.</p>

<p>Version strings are also used to enforce good browser caching habits, especially when you have a far-future expires header configured on your web server. For example, suppose you had the following asset:</p>

<pre class="code"><span class='lt op'>&lt;</span><span class='script identifier id'>script</span> <span class='type identifier id'>type</span><span class='assign token'>=</span><span class='string val'>&quot;text/javascript&quot;</span> <span class='src identifier id'>src</span><span class='assign token'>=</span><span class='string val'>&quot;/assets/milkshake.js?v=d3va&quot;</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='regexp val'>/script&gt;
</span></pre>

<p>When the contents of the asset change, the version will change in the query string:</p>

<pre class="code"><span class='lt op'>&lt;</span><span class='script identifier id'>script</span> <span class='type identifier id'>type</span><span class='assign token'>=</span><span class='string val'>&quot;text/javascript&quot;</span> <span class='src identifier id'>src</span><span class='assign token'>=</span><span class='string val'>&quot;/assets/milkshake.js?v=ae51&quot;</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='regexp val'>/script&gt;
</span></pre>

<p>Browsers will automatically re-download and cache the new asset.</p>

<h1>Rake tasks</h1>

<p>Rapper includes Rake tasks for packaging assets. Set this up in your <code>Rakefile</code>:</p>

<pre class="code"><span class='Rapper constant id'>Rapper</span><span class='colon2 op'>::</span><span class='Tasks constant id'>Tasks</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='config identifier id'>config</span><span class='bitor op'>|</span>
  <span class='config identifier id'>config</span><span class='lbrack token'>[</span><span class='symbol val'>:path</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;config/assets.yml&quot;</span>
  <span class='config identifier id'>config</span><span class='lbrack token'>[</span><span class='symbol val'>:env</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;production&quot;</span>
<span class='end end kw'>end</span>
</pre>

<p>Default namespace is <code>rapper</code>. The namespace can be changed as the first param:</p>

<pre class="code"><span class='Rapper constant id'>Rapper</span><span class='colon2 op'>::</span><span class='Tasks constant id'>Tasks</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:assets</span> <span class='do do kw'>do</span> <span class='dot3 op'>...</span>
</pre>

<p>Both config options are required.</p>

<h1>Development</h1>

<p>Rapper's got a Gemfile. You know what to do.</p>

<pre class="code"><span class='bundle identifier id'>bundle</span> <span class='install identifier id'>install</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='path identifier id'>path</span> <span class='vendor identifier id'>vendor</span>
<span class='bundle identifier id'>bundle</span> <span class='exec identifier id'>exec</span> <span class='rake identifier id'>rake</span> <span class='spec identifier id'>spec</span>
</pre>

<h2>Wishlist</h2>

<ul>
<li>Watch for CoffeeScript changes and automatically compile</li>
<li>Watch for Sass changes and automatically compile</li>
<li>Per-asset configuration overrides</li>
<li>Auto-setup Sinatra helpers (?)</li>
<li>Auto-setup Rails helpers (?)</li>
</ul>


<h2>Version history</h2>

<ul>
<li><strong>0.5.0</strong> - Added ability to nest bundles.</li>
<li><strong>0.4.0</strong> - Switching to YUI Compressor for JavaScript compression due to its better handling of local variable compressing in scopes with eval() usage (I'm looking at you, ExtJS). Adding <code>component_tag_root</code> and <code>asset_tag_root</code> options to allow better control over URLs.</li>
<li><strong>0.3.0</strong> - Remove hard Closure Compiler dependency (it will still need to be installed to compress JS), shorter view helper method names.</li>
<li><strong>0.2.4</strong> - Add tag_paths() to get all file paths for a given asset.</li>
<li><strong>0.2.2</strong> - Change tag_root behavior to not add <code>.../assets</code> path suffix when a <code>destination_root</code> is defined.</li>
<li><strong>0.2.1</strong> - Add tag_files() to get all file paths for a given asset.</li>
<li><strong>0.2.0</strong> - Custom asset destination roots, fix Rake task.</li>
<li><strong>0.1.1</strong> - Rake tasks.</li>
<li><strong>0.1.0</strong> - View helpers.</li>
<li><strong>0.0.3</strong> - New <code>Definition</code> object to make working with definitions significantly easier, don't re-package assets that don't need re-packaging.</li>
<li><strong>0.0.2</strong> - Compression now works and is specced.</li>
<li><strong>0.0.1</strong> - Initial release. Functioning bundler, minus the view helpers.</li>
</ul>


<h2>Contributing to rapper</h2>

<ul>
<li>Check out the latest master to make sure the feature hasn't been implemented or the bug hasn't been fixed yet</li>
<li>Check out the issue tracker to make sure someone already hasn't requested it and/or contributed it</li>
<li>Fork the project</li>
<li>Start a feature/bugfix branch</li>
<li>Commit and push until you are happy with your contribution</li>
<li>Make sure to add tests for it. This is important so I don't break it in a future version unintentionally.</li>
<li>Please try not to mess with the Rakefile, version, or history. If you want to have your own version, or is otherwise necessary, that is fine, but please isolate to its own commit so I can cherry-pick around it.</li>
</ul>


<h2>Copyright</h2>

<p>Copyright (c) 2011 Tyson Tate. See LICENSE.txt for further details.</p></div></div>
    
    <div id="footer">
  Generated on Fri Sep  2 12:59:23 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.4 (ruby-1.8.7).
</div>

  </body>
</html>