<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Documentation by YARD 0.6.4</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>rapper</h1>

<p>Static asset packager and compressor with versioning and built-in view helpers. Easy to configure, easy to use, and easy to ignore when you want to. No crazy JavaScript comment DSLs, either.</p>

<p>Merb and Sinatra view helpers are coming soon, as well as pluggable compression backends (YUI Compressor, Google Closure Compiler, etc.) <code>rapper</code> currently only includes Google Closure Compiler.</p>

<h2>Packaging assets without wanting to claw your eyes out</h2>

<ol>
<li>Create a config file and one or more asset type definition files.</li>
<li><p>Load <code>rapper</code> with the config path and current environment:</p>

<pre class="code"> <span class='engine identifier id'>engine</span> <span class='assign token'>=</span> <span class='Rapper constant id'>Rapper</span><span class='colon2 op'>::</span><span class='Engine constant id'>Engine</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='string val'>&quot;config/assets.yml&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;development&quot;</span> <span class='rparen token'>)</span>
</pre></li>
<li><p>Then package the assets:</p>

<pre class="code"> <span class='engine identifier id'>engine</span><span class='dot token'>.</span><span class='package identifier id'>package</span>
</pre></li>
<li><p>That's it. Stop fussing with ridiculous asset packagers that want you to spend an hour shuffling files around for them.</p></li>
</ol>


<h2>Rapper configuration</h2>

<p>Rapper is configured using a YAML file that defines the settings to be used in various server environments. Example:</p>

<pre class="code"><span class='base identifier id'>base</span><span class='colon op'>:</span> <span class='bitand op'>&amp;</span><span class='base identifier id'>base</span>
  <span class='definition_root identifier id'>definition_root</span><span class='colon op'>:</span> <span class='config identifier id'>config</span><span class='div op'>/</span><span class='assets identifier id'>assets</span>
  <span class='tag_style identifier id'>tag_style</span><span class='colon op'>:</span> <span class='html identifier id'>html</span>   <span class='comment val'># optional, [&quot;html&quot;, &quot;xhtml&quot;, &quot;html5&quot;], default: html5</span>

<span class='development identifier id'>development</span><span class='colon op'>:</span>
  <span class='lshft op'>&lt;&lt;</span><span class='colon op'>:</span> <span class='mult op'>*</span><span class='base identifier id'>base</span>
  <span class='bundle identifier id'>bundle</span><span class='colon op'>:</span> <span class='false false kw'>false</span>     <span class='comment val'># optional, default: true</span>
  <span class='compress identifier id'>compress</span><span class='colon op'>:</span> <span class='false false kw'>false</span>   <span class='comment val'># optional, default: true</span>
  <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='false false kw'>false</span>    <span class='comment val'># optional, default: true</span>
  <span class='log identifier id'>log</span><span class='colon op'>:</span> <span class='stdout identifier id'>stdout</span>       <span class='comment val'># optional, [&quot;stdout&quot;, file path], default: off</span>
  <span class='log_verbose identifier id'>log_verbose</span><span class='colon op'>:</span> <span class='true true kw'>true</span> <span class='comment val'># optional, default: off</span>

<span class='production identifier id'>production</span><span class='colon op'>:</span>
  <span class='lshft op'>&lt;&lt;</span><span class='colon op'>:</span> <span class='mult op'>*</span><span class='base identifier id'>base</span>
  <span class='bundle identifier id'>bundle</span><span class='colon op'>:</span> <span class='true true kw'>true</span>
  <span class='compress identifier id'>compress</span><span class='colon op'>:</span> <span class='true true kw'>true</span>
  <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='true true kw'>true</span>
  <span class='comment val'># optional, passed to Google Closure Compiler</span>
  <span class='closure_compiler identifier id'>closure_compiler</span><span class='colon op'>:</span>
    <span class='comment val'># default: SIMPLE_OPTIMIZATIONS</span>
    <span class='compilation_level identifier id'>compilation_level</span><span class='colon op'>:</span> <span class='ADVANCED_OPTIMIZATIONS constant id'>ADVANCED_OPTIMIZATIONS</span>
</pre>

<p>The only required setting is <code>definition_root</code>. (Of course, you'll still need definition files to define the asset packages that you want build. More on that below.)</p>

<p>The minimum settings needed for a configuration file is:</p>

<pre class="code"><span class='base identifier id'>base</span><span class='colon op'>:</span>
  <span class='definition_root identifier id'>definition_root</span><span class='colon op'>:</span> <span class='config identifier id'>config</span><span class='div op'>/</span><span class='assets identifier id'>assets</span>
</pre>

<p>The following defaults are applied if not defined in your configuration:</p>

<pre class="code"><span class='bundle identifier id'>bundle</span><span class='colon op'>:</span> <span class='true true kw'>true</span>
<span class='compress identifier id'>compress</span><span class='colon op'>:</span> <span class='true true kw'>true</span>
<span class='tag_style identifier id'>tag_style</span><span class='colon op'>:</span> <span class='html5 identifier id'>html5</span>
<span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='true true kw'>true</span>
<span class='closure_compiler identifier id'>closure_compiler</span><span class='colon op'>:</span>
  <span class='compilation_level identifier id'>compilation_level</span><span class='colon op'>:</span> <span class='SIMPLE_OPTIMIZATIONS constant id'>SIMPLE_OPTIMIZATIONS</span>
</pre>

<h2>Rapper definitions</h2>

<p>The <code>definition_root</code> setting in the rapper config is a path to a folder containing more YAML files that define the various types of bundles you want to build (eg. <code>stylesheets.yml</code>, <code>javascripts.yml</code>) Example definition file:</p>

<pre class="code"><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span> 
<span class='minus op'>-</span> <span class='source_root identifier id'>source_root</span><span class='colon op'>:</span> <span class='public identifier id'>public</span><span class='div op'>/</span><span class='javascripts identifier id'>javascripts</span>
<span class='minus op'>-</span> <span class='destination_root identifier id'>destination_root</span><span class='colon op'>:</span> <span class='public identifier id'>public</span><span class='div op'>/</span><span class='assets identifier id'>assets</span><span class='div op'>/</span><span class='javascripts identifier id'>javascripts</span>
<span class='minus op'>-</span> <span class='suffix identifier id'>suffix</span><span class='colon op'>:</span> <span class='js identifier id'>js</span>
<span class='minus op'>-</span> <span class='assets identifier id'>assets</span><span class='colon op'>:</span> 
  <span class='minus op'>-</span> <span class='base identifier id'>base</span><span class='colon op'>:</span> 
    <span class='minus op'>-</span> <span class='files identifier id'>files</span><span class='colon op'>:</span> 
      <span class='minus op'>-</span> <span class='mootools identifier id'>mootools</span>
  <span class='minus op'>-</span> <span class='stats identifier id'>stats</span><span class='colon op'>:</span> 
    <span class='minus op'>-</span> <span class='files identifier id'>files</span><span class='colon op'>:</span> 
      <span class='minus op'>-</span> <span class='protovis identifier id'>protovis</span>
      <span class='minus op'>-</span> <span class='ext_js_full identifier id'>ext_js_full</span>
</pre>

<p>The above definition will create two asset files: <code>public/assets/javascripts/base.js</code> and <code>public/assets/javascripts/stats.js</code> from the component files in <code>public/javascripts</code> (in this case: <code>public/javascripts/protovis.js</code> and <code>public/javascripts/ext_js_full.js</code>).</p>

<p><strong>Note:</strong> Definition files are YAML ordered mapping documents. This is so that version updates (which involves rapper updating the version numbers and writing out the updated definition as YAML) don't change the order of the file. This is especially useful when using git and working with many branches because it prevents nasty merge conflicts.</p>

<h2>Versioning</h2>

<p>If versioning is turned on in your config, version strings will be used to enforce better browser caching of assets. (Version numbers are always used in definition files.)</p>

<pre class="code"><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span> 
<span class='minus op'>-</span> <span class='source_root identifier id'>source_root</span><span class='colon op'>:</span> <span class='public identifier id'>public</span><span class='div op'>/</span><span class='javascripts identifier id'>javascripts</span>
<span class='minus op'>-</span> <span class='destination_root identifier id'>destination_root</span><span class='colon op'>:</span> <span class='public identifier id'>public</span><span class='div op'>/</span><span class='assets identifier id'>assets</span><span class='div op'>/</span><span class='javascripts identifier id'>javascripts</span>
<span class='minus op'>-</span> <span class='suffix identifier id'>suffix</span><span class='colon op'>:</span> <span class='js identifier id'>js</span>
<span class='minus op'>-</span> <span class='assets identifier id'>assets</span><span class='colon op'>:</span> 
  <span class='minus op'>-</span> <span class='base identifier id'>base</span><span class='colon op'>:</span> 
    <span class='minus op'>-</span> <span class='files identifier id'>files</span><span class='colon op'>:</span> 
      <span class='minus op'>-</span> <span class='mootools identifier id'>mootools</span>
    <span class='minus op'>-</span> <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='integer val'>7</span><span class='b06 identifier id'>b06</span>
  <span class='minus op'>-</span> <span class='stats identifier id'>stats</span><span class='colon op'>:</span> 
    <span class='minus op'>-</span> <span class='files identifier id'>files</span><span class='colon op'>:</span> 
      <span class='minus op'>-</span> <span class='protovis identifier id'>protovis</span>
      <span class='minus op'>-</span> <span class='ext_js_full identifier id'>ext_js_full</span>
    <span class='minus op'>-</span> <span class='version identifier id'>version</span><span class='colon op'>:</span> <span class='db62 identifier id'>db62</span>
</pre>

<p>Version strings are short hashes of the pre-compression asset file. This means that they will only change when the contents of the component files for an asset change and time-consuming compression will only happen when a bundle needs to be re-packaged.</p>

<p>Version strings are also used to enforce good browser caching habits, especially when you have a far-future expires header configured on your web server. For example, suppose you had the following asset:</p>

<pre class="code"><span class='lt op'>&lt;</span><span class='script identifier id'>script</span> <span class='type identifier id'>type</span><span class='assign token'>=</span><span class='string val'>&quot;text/javascript&quot;</span> <span class='src identifier id'>src</span><span class='assign token'>=</span><span class='string val'>&quot;/assets/milkshake.js?v=d3va&quot;</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='regexp val'>/script&gt;
</span></pre>

<p>When the contents of the asset change, the version will change in the query string:</p>

<pre class="code"><span class='lt op'>&lt;</span><span class='script identifier id'>script</span> <span class='type identifier id'>type</span><span class='assign token'>=</span><span class='string val'>&quot;text/javascript&quot;</span> <span class='src identifier id'>src</span><span class='assign token'>=</span><span class='string val'>&quot;/assets/milkshake.js?v=ae51&quot;</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='regexp val'>/script&gt;
</span></pre>

<p>Browsers will automatically re-download and cache the new asset.</p>

<h2>To do soon</h2>

<ul>
<li>Merb view helpers</li>
<li>Sinatra helpers</li>
</ul>


<h2>To do later</h2>

<ul>
<li>Per-asset configuration overrides</li>
<li>Rails helpers</li>
<li>Watch for CoffeeScript changes and automatically compile</li>
<li>Watch for Sass changes and automatically compile</li>
</ul>


<h2>Version history</h2>

<ul>
<li><strong>0.0.3</strong> - New <code>Definition</code> object to make working with definitions significantly easier, don't re-package assets that don't need re-packaging.</li>
<li><strong>0.0.2</strong> - Compression now works and is specced.</li>
<li><strong>0.0.1</strong> - Initial release. Functioning bundler, minus the view helpers.</li>
</ul>


<h2>Contributing to rapper</h2>

<ul>
<li>Check out the latest master to make sure the feature hasn't been implemented or the bug hasn't been fixed yet</li>
<li>Check out the issue tracker to make sure someone already hasn't requested it and/or contributed it</li>
<li>Fork the project</li>
<li>Start a feature/bugfix branch</li>
<li>Commit and push until you are happy with your contribution</li>
<li>Make sure to add tests for it. This is important so I don't break it in a future version unintentionally.</li>
<li>Please try not to mess with the Rakefile, version, or history. If you want to have your own version, or is otherwise necessary, that is fine, but please isolate to its own commit so I can cherry-pick around it.</li>
</ul>


<h2>Copyright</h2>

<p>Copyright (c) 2011 Tyson Tate. See LICENSE.txt for further details.</p></div></div>
    
    <div id="footer">
  Generated on Sat Feb 19 01:03:08 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.4 (ruby-1.8.7).
</div>

  </body>
</html>